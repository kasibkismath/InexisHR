<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:security="http://www.springframework.org/schema/security"
	xsi:schemaLocation="http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

	<security:authentication-manager>
		<security:authentication-provider>
			<security:jdbc-user-service
				data-source-ref="dataSource"
				authorities-by-username-query="select username, authority from users where binary username=?"
				users-by-username-query="select username, password, enabled from users where binary username=?"
				id="JDBCAuthManager" />
			<security:password-encoder ref="passwordEncoder">
			</security:password-encoder>
		</security:authentication-provider>
	</security:authentication-manager>

	<bean id="customAuthenticationSuccessHandler"
		class="com.inexisconsulting.customConfig.CustomAuthenticationSuccessHandler">
	</bean>

	<security:http use-expressions="true">
		<security:intercept-url pattern="/admin-main-menu"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/user-main-menu"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/ceo-main-menu"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/hr-main-menu"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/lead-main-menu"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/user/settings"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/user/settings/user"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/user/settings/getUser"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/user/settings/updateUser"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/user/settings/updateUserPassword"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/sendChangePasswordMail"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/backupDatabase"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/restoreDatabase"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/administration"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/administration/user/currentUser"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/administration/user/all"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/administration/user/delete"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/administration/user/getEditUser"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/administration/user/updateEditUser"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/administration/user/addNewUser"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/administration/user/checkUserExists"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/employeeProfile"
			access="hasRole('ROLE_ADMIN')" />
		<security:intercept-url pattern="/employeeProfile/employee/all"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/employeeProfile/employee/addNewEmp"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/employeeProfile/employee/updateImageURL"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/employeeProfile/employee/checkEmpExists"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/employeeProfile/employee/getById"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/employeeProfile/employee/getEditEmp"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/employeeProfile/employee/updateEditBasicInfoEmp"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/employeeProfile/employee/updateEditEduFormDetails"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/employeeProfile/employee/updateWorkHistory"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/employeeProfile/employee/deleteEmployee"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/employeeProfile/employee/getEmpDesignationData"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/employeeProfile/employee/getStatus"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/employeeProfile/employee/disable"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/employeeProfile/MyProfile"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/employeeProfile/MyProfile/getEmployee"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/desgination/all"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/designation/getDesignationById"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/designation/checkDesignationExists"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/designation/updateDesignation"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/designation/deleteDesignationById"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/designation/addDesignation"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/CheckPerformanceExists"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/AllPerformanceAppraisals"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/getPerformanceId"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/AddCEOAppraisal"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/AddPerformance"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/GetTeamEmployeeByLeadId"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/AddLeadAppraisal"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/CheckAppraisalYear"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/GetTeamsByLeadId"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/CheckDuplicateLeadAppraisal"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/GetTeamEmployeeCountByEmpId"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/GetCompleteLeadAppraisalCountByEmpId"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/CheckLeadAppraisalComplete"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/GetUserRoleByEmpId"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/AddHRAppraisal"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/CheckHRAppraisalExists"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/CheckDuplicateHRAppraisal"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/CheckDuplicateCEOAppraisal"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/FinalScoreCalculation"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/UpdatePerformanceFinalScoreAndStatus"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/GetLeadAppraisalsByLeadId"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/GetLeadAppraisalByLeadAppraisalId"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/SaveEditLeadAppraisal"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/DeleteLeadAppraisal"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/GetTotalScoresByLeadId"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/GetHRAppraisals"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/GetHRAppraisalByAppraisalId"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/SaveEditHRAppraisal"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/DeleteHRAppraisal"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/GetTotalScoresByHR"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/GetCEOAppraisals"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/GetCEOAppraisalByAppraisalId"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/UpdateCEOAppraisalByAppraisalId"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/DeleteCEOAppraisal"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Performance/GetFinalScoreEmployeeByCEO"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/GetLeaveTypes"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/GetCasualLeaveTypeId"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/GetMedicalLeaveTypeId"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/GetLeaveTypeId"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/GetLeaveSumByLeaveTypeAndYear"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/GetLeaveSumByYearForCausalAndMedicalLeaves"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/CheckDuplicateLeave"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/AddLeave"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/SendLeaveRequestMail"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/GetLeavesForLoggedInEmployee"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/GetLeaveByLeaveId"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/UpdateLeave"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/SendUpdatedLeaveRequestMail"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/DeleteLeave"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/SendDeleteLeaveRequestMail"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/GetPendingLeaveCountByYear"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/GetApprovedLeaveCountByYear"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/GetLeaveTypeSumByYear"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/GetAllLeavesByYear"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/UpdateLeaveStatus"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/Leave/SendLeaveStatusUpdateMail"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/FileUpload"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/header"
			access="isAuthenticated()" />
		<security:intercept-url pattern="/" access="permitAll" />
		<security:intercept-url pattern="/static/**"
			access="permitAll" />
		<security:intercept-url pattern="/**" access="denyAll" />
		
		
		<security:form-login login-page="/"
			authentication-failure-url="/?error=true"
			authentication-success-handler-ref="customAuthenticationSuccessHandler" />

		<security:logout logout-success-url="/"
			invalidate-session="true" delete-cookies="JSESSIONID" />
		<security:remember-me key="HRAppKey"
			user-service-ref="JDBCAuthManager" />
			
	</security:http>

	<bean id="passwordEncoder"
		class="org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder">
	</bean>
</beans>
